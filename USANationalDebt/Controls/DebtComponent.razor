

<div class="MainDiv d-flex flex-fill">
    <div class="header text-bold text-center">
        @Title
    </div>
    <div class="money text-bold text-center trapezoid">
        <div class="money_outline">
            <span class="money_text">$</span>
            <span class="money_text" id="babki">@Debt</span>
        </div>
    </div>
</div>


@code{
    [Parameter]
    public string Title { get; set; }

    [Parameter]
    public DateTime ActualTime { get; set; }

    [Parameter]
    public DebtModelRead model { get; set; }

    public double Debt { get; set; }

    public double Increment { get; set; }

    Random random = new Random(DateTime.Now.Second);

    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();

        TimeSpan span = ActualTime - model.Day;


        Debt = model.Debt;
        Increment = model.Increase;
        Debt += (span.TotalSeconds * model.Increase);

        await Start();
    }


    async Task Start()
    {
        await Task.Delay(1000);
        while (true)
        {
            await Timer();
        }

    }

    async Task Timer()
    {
        int delay = random.Next(500, 1500);
        await Task.Delay(delay);
        await AfterTime();
    }

    async Task AfterTime()
    {
        double increment =Math.Round(Increment*((double)random.Next(60,140)/100),2);
        Debt += increment;
        StateHasChanged();
    }
}

